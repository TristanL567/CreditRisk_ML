# GLM Code Integration - Summary

## What Was Done

The R code for GLM analysis has been properly integrated with your existing codebase. The `.Rnw` documentation now references your actual implementation rather than creating duplicate code.

## File Structure

```
CreditRisk_ML/
├── 01_Code/
│   ├── Main.R                          # Main analysis script (existing)
│   ├── Run_GLM_Analysis.R             # NEW: GLM execution wrapper
│   └── Subfunctions/
│       ├── GLM_gridsearch.R           # Existing GLM functions
│       ├── GLM_bayesoptim.R
│       ├── DataPreprocessing.R
│       ├── QuantileTransformation.R
│       └── MVstratifiedsampling.R
│
├── 03_Charts/
│   └── GLM/                           # Generated by Main.R
│       └── 01_HyperparameterTuningMethods_AUC_Training.png
│
└── 06_Documentation/
    ├── Methodology_Summary.Rnw        # UPDATED: Now sources existing code
    ├── Load_GLM_Results.R             # NEW: Helper to load results
    ├── compile_workflow.sh            # NEW: Complete workflow automation
    ├── README.md                      # NEW: Documentation guide
    └── Results/                       # NEW: Directory for exports
        ├── glm_results.rds           # Generated by Run_GLM_Analysis.R
        └── glm_method_comparison.csv
```

## How It Works

### 1. **Main.R** (Lines 195-394)
Your existing implementation that:
- Loads and preprocesses data
- Applies feature engineering (standardization + quantile transform)
- Creates stratified CV folds
- Runs three hyperparameter tuning methods:
  - Discrete Grid Search (11 alpha values)
  - Random Search (20 random alphas)
  - Bayesian Optimization (15 iterations)
- Evaluates on test set
- Generates visualization

### 2. **Run_GLM_Analysis.R** (NEW)
Wrapper script that:
- Sources Main.R
- Extracts GLM results
- Exports to `Results/` directory
- Prints summary

### 3. **Methodology_Summary.Rnw** (UPDATED)
Documentation that:
- Describes methodology (existing text)
- References your code locations
- Loads results from `Results/`
- Displays tables and figures
- **Does NOT re-execute** the full analysis

### 4. **Load_GLM_Results.R** (NEW)
Helper script that:
- Loads exported results
- Formats for LaTeX tables
- Handles missing results gracefully

## Usage

### Option 1: Complete Workflow (Recommended)
```bash
cd CreditRisk_ML/06_Documentation
./compile_workflow.sh
```

This will:
1. Run GLM analysis
2. Export results
3. Compile PDF documentation

### Option 2: Step-by-Step

**Step 1: Run Analysis**
```r
setwd("CreditRisk_ML/01_Code")
source("Run_GLM_Analysis.R")
```

**Step 2: Compile Documentation**
```r
library(knitr)
setwd("CreditRisk_ML/06_Documentation")
knit2pdf("Methodology_Summary.Rnw")
```

## Key Changes Made

### 1. **Methodology_Summary.Rnw**
- **Before**: Contained standalone GLM code (would need data, wouldn't match Main.R)
- **After**: References existing `Main.R` implementation, loads pre-computed results

### 2. **Integration Points**
- Preprocessing: Uses `DataPreprocessing.R` (existing)
- Feature Engineering: Uses `QuantileTransformation.R` (existing)  
- Sampling: Uses `MVstratifiedsampling.R` and `MVstratifiedsampling_CV.R` (existing)
- GLM Training: Uses `GLM_gridsearch.R` and `GLM_bayesoptim.R` (existing)

### 3. **Results Flow**
```
Main.R → Run_GLM_Analysis.R → Results/*.rds → Load_GLM_Results.R → .Rnw Tables
```

## Important Notes

### Data Path Configuration
In `Main.R` line 56, update this path to your data location:
```r
Data_Path <- "C:/Users/TristanLeiter/Documents/Privat/ILAB/Data/WS2025"
```

Or use a relative path:
```r
Data_Path <- file.path(Path, "data")
```

### Chart Paths
The `.Rnw` file expects charts in:
```
CreditRisk_ML/03_Charts/GLM/01_HyperparameterTuningMethods_AUC_Training.png
```

Verify the graphicspath in `.Rnw` line 47:
```latex
\graphicspath{
    {C:/Users/TristanLeiter/Documents/Privat/ILAB/CreditRisk_ML/03_Charts/XGBoost/}
}
```

You may need to update this for GLM charts or add a relative path.

## Benefits of This Approach

1. **Single Source of Truth**: Main.R is the authoritative implementation
2. **No Code Duplication**: .Rnw references rather than reimplements
3. **Maintainability**: Changes to Main.R automatically reflected in documentation
4. **Reproducibility**: Clear workflow from analysis to documentation
5. **Separation of Concerns**: Analysis code separate from documentation markup

## Comparison with Python Implementation

You also have Python implementations in `notebooks/`. Consider:

- **R implementation** (Main.R): Full hyperparameter tuning with 3 methods
- **Python implementation** (notebooks/): Uses AutoGluon

Document which is your "official" methodology, or include both with comparison.

## Next Steps

1. **Update Data Path** in Main.R line 56
2. **Run Workflow**: Execute `compile_workflow.sh`
3. **Review Output**: Check `Methodology_Summary.pdf`
4. **Iterate**: Update Main.R, re-run workflow to update docs
5. **Extend**: Apply same pattern for XGBoost, Random Forest sections

## Questions?

- Results not loading? Check that `glm_results.rds` exists in `Results/`
- Charts not appearing? Verify paths in `.Rnw` line 47
- Data not found? Update `Data_Path` in Main.R
- Compilation errors? Check LaTeX log in `06_Documentation/`
